{% extends "base.html" %}
{% block content %}
<div class="page-head">
  <h1 class="h1">Service Providers</h1>
  <div class="sub">Browse, filter, and add service providers</div>
</div>

<div class="card">
  <div class="toolbar">
    <form method="get" class="filters">
      <input type="text" name="q" value="{{ q }}" placeholder="Search: name, phone, email, address, skills">

      <select name="category">
        <option value="">All categories</option>
        {% for c in categories %}
          <option value="{{ c.id }}" {% if category|stringformat:'s' == c.id|stringformat:'s' %}selected{% endif %}>{{ c.name }}</option>
        {% endfor %}
      </select>

      <select name="active">
        <option value="">Any status</option>
        <option value="yes" {% if active == 'yes' %}selected{% endif %}>Active</option>
        <option value="no"  {% if active == 'no'  %}selected{% endif %}>Inactive</option>
      </select>

      <button class="btn" type="submit">Filter</button>
      <a class="btn ghost" href="{% url 'providers:list' %}">Reset</a>
    </form>

    <!-- Top-right action -->
    <div class="actions" style="margin-left:auto">
      <a class="btn" href="{% url 'providers:register' %}">Add new Service Provider</a>
    </div>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>Category</th><th>Name</th><th>Phone</th><th>Email</th><th>Address</th><th>Active</th><th style="width:180px"></th>
      </tr>
    </thead>
    <tbody>
      {% for p in object_list %}
      <tr>
        <td>{{ p.category.name }}</td>
        <td>{{ p.full_name }}</td>
        <td>{{ p.phone|default:"—" }}</td>
        <td>{{ p.email|default:"—" }}</td>
        <td>{{ p.address|default:"—" }}</td>
        <td>{% if p.is_active %}<span class="badge ok">Yes</span>{% else %}<span class="badge muted">No</span>{% endif %}</td>
        <td>
          <a class="btn ghost sm" href="{% url 'providers:edit' p.pk %}">Edit</a>
          <a class="btn ghost danger sm" href="{% url 'providers:delete' p.pk %}">Delete</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="7" class="muted">
          No providers found.
          <a class="btn" href="{% url 'providers:register' %}" style="margin-left:8px;">Add new Service Provider</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% if is_paginated %}
  <div class="pager">
    {% if page_obj.has_previous %}
      <a class="btn ghost sm" href="?page={{ page_obj.previous_page_number }}&q={{ q }}&category={{ category }}&active={{ active }}">Prev</a>
    {% endif %}
    <span class="muted">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a class="btn ghost sm" href="?page={{ page_obj.next_page_number }}&q={{ q }}&category={{ category }}&active={{ active }}">Next</a>
    {% endif %}
  </div>
  {% endif %}
</div>
{% endblock %}
